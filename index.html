<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Red Green Word Game</title>
  <meta name="description" content="Red Green Word Game">
  <meta name="author" content="Liam Devaney">
  <link rel="stylesheet" href="css/styles.css?v=25-10-16">
  <link rel="stylesheet" href="css/bootstrap.css?v=25-10-16">
  <link rel="stylesheet" href="css/bootstrap-theme.css?v=25-10-16">
  <script src="scripts/my.js"></script>
  <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script>
  <![endif]-->
</head>
<body onload="getShuffledListOfWords()">
<div class="stage-wrap" onload="">
  <div id="intro-wrap">
    <h1 id="initial-intro"><span class="red-me">Red Word</span> or <span class="green-me">Green word</span></h1>
    <div>
      <table id="results-table">
      <thead></thead>
      <tbody></tbody>  
      </table>
    </div>
    <div class="start-btn-wrap">
      <button type="button" class="btn btn-block btn-primary btn-lg" id="start-game" onclick="getShuffledListOfWords(), getNewWord(),  selection_snd.play(), clearTimer(), timerStart()">Start<br>10 words</button>
    </div>
  </div>

  <div id="game-wrap">
    <div id="back-btn"><a href="#" class="btn btn-default" onclick="restartGame()">Back</a></div>
    <div class="timer" id="timer">0 seconds</div>
    <div class="error-screen-block" id="error-screen-block">X
      <div class="sad">
  <div class="container">
    <div>:(</div>
  </div><!-- .container -->
</div></div>
    <h2 id="current-word"></h2>
    <div id="happy-face-animation">
        <div class="container">
  <div class="one">;)</div>
</div><!-- .container -->
<div class="container">
  <div class="two">:)</div>
</div><!-- .container -->
<div class="container">
  <div class="three">:D</div>
</div><!-- .container -->
<div class="container">
  <div class="four">:)</div>
</div><!-- .container -->
<div class="container">
  <div class="five">:*</div>
</div><!-- .container -->
    </div>
    <div class="answer-btn-wrap">
      <button type="button" class="btn btn-danger btn-lg" id="is_red">Red</button>
      <button type="button" class="btn btn-success btn-lg" id="is_green">Green</button>
    </div>
  </div>

</div>
<script>

function addResultsTableRow(tableID, cellOne, cellTwo) {
  // Get a reference to the table
  var tableRef = document.getElementById(tableID);
  var newRow = tableRef.insertRow(0);

  var newCell = newRow.insertCell(0);
  var newText = document.createTextNode(cellOne);
  newCell.appendChild(newText);

  var secondNewCell = newRow.insertCell(1);
  var secondNewText = document.createTextNode(cellTwo);
  secondNewCell.appendChild(secondNewText);
};

var selection_snd = new Audio("sounds/selection.mp3");
var correct_snd = new Audio("sounds/correct.mp3");
var wrong_snd = new Audio("sounds/wrong.mp3"); 
var end_snd = new Audio("sounds/end-sound.mp3"); 
//var welcome_snd = new Audio("sounds/intro-music.wav");
//welcome_snd.loop = true;
//welcome_snd.play();

function getShuffledListOfWords() {
    // setting up the GET request
    function readTextFile(file, callback) {
        var rawFile = new XMLHttpRequest();
        rawFile.overrideMimeType("application/json");
        rawFile.open("GET", file, true);
        rawFile.onreadystatechange = function() {
            if (rawFile.readyState === 4 && rawFile.status == "200") {
                callback(rawFile.responseText);
            }
        }
        rawFile.send(null);
    };
    
    function randomize(a, b) {
        return Math.random() - 0.5;
    };
    
    // Calling the data
    readTextFile("data/eyfsWords.json", function(text){
        words = JSON.parse(text);
        words.eyfsWords.sort(randomize);
    });//readTextFile

};//getShuffledListOfWords

var correct_answers = 90;

function getNewWord() {
    var roundSeconds = 0;
    roundTimeVar = setInterval(roundCountStart, 1000);

    function roundCountStart() {
        ++roundSeconds;
        var roundHour = Math.floor(roundSeconds /3600);
        var roundMinute = Math.floor((roundSeconds - roundHour*3600)/60);
        endRoundTime = roundSeconds;
    };


    document.getElementById("current-word").innerHTML = "<p>" + words.eyfsWords[correct_answers].word + " </p>";// class="+ words.eyfsWords[correct_answers].colour + "
    document.getElementById("intro-wrap").style.display = 'none';
    document.getElementById("game-wrap").style.display = 'block';
    document.getElementById("is_"+words.eyfsWords[correct_answers].colour).className += " correct_answer_btn";
    document.getElementById("is_red").onclick = answer;
    document.getElementById("is_green").onclick = answer;
};

function answer() {
    if (this.classList.contains("correct_answer_btn")) {
        correct_snd.play();
        addResultsTableRow('results-table', words.eyfsWords[correct_answers].word, endRoundTime);
        correct_answers++; //Add 1 to correct answers
        document.getElementById('happy-face-animation').style.display='block';
        setTimeout(function () {document.getElementById('happy-face-animation').style.display='none'}, 2000);
        this.classList.remove("correct_answer_btn");
        if (correct_answers == words.eyfsWords.length) {
            endGame();
        } else{
        getNewWord();
        };
    } else{
        wrong_snd.play();
        document.getElementById('error-screen-block').style.display='block';
        setTimeout(function () {
            document.getElementById('error-screen-block').style.display='none'},
            4000);
    };
}; // function answer()

function endGame() {
    usersTime = document.getElementById("timer").innerHTML;
    document.getElementById("intro-wrap").style.display = 'block';
    document.getElementById("game-wrap").style.display = 'none';
    document.getElementById("initial-intro").innerHTML = "Well done<br>You did it in<br>" + usersTime;
    correct_answers = 90;
    end_snd.play();
    stopTimer();
};

function restartGame() {
    correct_answers = 90;
    document.getElementById("intro-wrap").style.display = 'block';
    document.getElementById("game-wrap").style.display = 'none';
    document.getElementById("is_red").classList.remove("correct_answer_btn");
    document.getElementById("is_green").classList.remove("correct_answer_btn");
    stopTimer();
    clearTimer();
};


function timerStart() {
    timerVar = setInterval(countStart, 1000);
    totalSeconds = 0;
    function countStart() {
        ++totalSeconds;
        var hour = Math.floor(totalSeconds /3600);
        var minute = Math.floor((totalSeconds - hour*3600)/60);
        var seconds = totalSeconds;
        document.getElementById("timer").innerHTML = seconds + " seconds";
    };
};

function clearTimer() {
    totalSeconds = 0;
    document.getElementById("timer").innerHTML = " 0 minutes 0 seconds";
};

function stopTimer() {
    clearInterval(timerVar);
};

</script>
</body>
</html> 
